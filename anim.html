<html>
    <head>
        <title>Moving Car Animation with CSS</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            body{
                padding: 0px;
                margin: 0px;
            }
            .game{
                background: red;
                -webkit-animation: changeBackground 150s infinite; 
            }
            .road{
                position: fixed;
                bottom:0px;
                height: 160px;
                width: 100%;
                background-color: #333333;
            }
            .car{
                position: fixed;
                bottom:35px;
                left: auto;
                right: auto;
                width:200px;
                z-index: 1001;
                -webkit-animation: movecar 15s infinite; 
            }
            .bot-car{
                position: fixed;
                bottom:35px;
                width:200px;
                z-index: 1000;
                -webkit-animation: movebotcar 15s infinite; 
            }
            .sun{
                border: 1px solid white;
                border-radius: 50%;
                width:100px;
                height: 100px;
                position: fixed;
                background: orangered;
                -webkit-animation: sunAnim 150s infinite;
            }

            .moon{
                border: 1px solid white;
                border-radius: 50%;
                width:30px;
                height: 30px;
                position: fixed;
                background: white;
                -webkit-animation: moonAnim 150s infinite;
            }
            .bg-music{
                visibility: hidden;
            }
            .divider{
                position: absolute;
                width: 100%;
                bottom:70px;
                border: 5px dotted white;
            }
            .grassB{
                position: fixed;
                width:65%;
                bottom:160px;
                border-top-right-radius: 100%;
                height: 100px;
                z-index: 1000;
                background: #3B5323;
            }
            .grassC{
                position: fixed;
                width:55%;
                bottom:160px;
                right:0px;
                border-top-left-radius: 100%;
                height: 200px;
                z-index: 10;
                background: #526F35;
            }
            .roadBorder{
                position: fixed;
                width:100%;
                bottom:160px;
                height: 10px;
                z-index: 1000;
                background: brown;
            }
            .pole{
                position: fixed;
                width:5px;
                left:25%;
                bottom:160px;
                height: 100px;
                z-index: 1000;
                background: linear-gradient(141deg, gray 0%, white 51%, gray 75%);
            }
            .pole p{
                width: 15px;
                height: 20px;
                bottom: 243px;
                background: yellow;
                border-radius: 50%;
                position: fixed;
                left: 24.7%;
                box-shadow: 0px -2px 36px orange;
            }
            .pole1{
                position: fixed;
                width:5px;
                left:50%;
                bottom:160px;
                height: 100px;
                z-index: 1000;
                background: linear-gradient(141deg, gray 0%, white 51%, gray 75%);
            }
            .pole1 p{
                width: 15px;
                height: 20px;
                bottom: 243px;
                background: yellow;
                border-radius: 50%;
                position: fixed;
                left: 49.6%;
                box-shadow: 0px -2px 36px orange;
            }
            .pole2{
                position: fixed;
                width:5px;
                left:75%;
                bottom:160px;
                height: 100px;
                z-index: 1000;
                background: linear-gradient(141deg, gray 0%, white 51%, gray 75%);
            }
            .pole2 p{
                width: 15px;
                height: 20px;
                bottom: 243px;
                background: yellow;
                border-radius: 50%;
                position: fixed;
                left: 74.7%;
                box-shadow: 0px -2px 36px orange;
            }
            .star{
                background: yellow;
                position: fixed;
                box-shadow: 1px -2px 79px orange;
            }
            @keyframes movecar {
                from {left : -10%;}
                to {left: 100%; bottom:80px}
            }

            @keyframes movebotcar {
                from {left : 100%;}
                to {left: -15%; bottom:80px}
            }
            @keyframes changeBackground {
                from {background-color: skyblue;}
                to {background-color: black;}
            }
            @keyframes sunAnim {
                from {background-color: yellow; width:100px; height:100px; left:40px; top: 0%;}
                to {background-color: orange; width:70px; height:70px; left:500px; top: 100%;}
            }
            @keyframes moonAnim {
                from {background-color: white; left:50%; top: -20%;}
                to {background-color: whitesmoke; box-shadow: 0px 0px 5px whitesmoke; left:60%; top: 10%;}
            }
        </style>

    </head>
    <body class="wrap">
        <div class="game">
            <div class="sun">

            </div>
            <div class="moon">

            </div>
            <div class="grassB">

            </div>
            <div class="grassC">

            </div>

            <div class="roadBorder">

            </div>

            <div class="pole">
                <p></p>
            </div>
            <div class="pole1">
                <p></p>
            </div>
            <div class="pole2">
                <p></p>
            </div>
            <div class="star">
            </div>
            <img src="car.png" class="car">
            <img src="bot.png" class="bot-car">
            <div class="road">

                <div class="divider">

                </div>
            </div>
            <audio controls autoplay="" class="bg-music">
                <source src="car-acc.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>
        <div class="scoreboard hidden" >
            <h1>Score Card</h1>
            <table>
                <tr>
                    <td>Vinod</td>
                    <td>100000000</td>
                </tr>
                <tr>
                    <td>Vinod</td>
                    <td>100000000</td>
                </tr>
            </table>
        </div>
        <script type="text/javascript" src='jquery.js'></script>
        <script>
            $(document).keydown(function (e) {
                switch (e.which) {
                    case 37: // left
                        moveCarLeft();
                        break;

                    case 38: // up
                        moveCarUp();
                        break;

                    case 39: // right
                        moveCarRight();
                        break;

                    case 40: // down
                        moveCarDown();
                        break;

                    default:
                        return; // exit this handler for other keys
                }
                e.preventDefault();
            });

            jQuery.fn.onPositionChanged = function (trigger, millis) {
                if (millis == null)
                    millis = 100;
                var o = $(this[0]); // our jquery object
                if (o.length < 1)
                    return o;

                var lastPos = null;
                var lastOff = null;
                setInterval(function () {
                    if (o == null || o.length < 1)
                        return o; // abort if element is non existend eny more
                    if (lastPos == null)
                        lastPos = o.position();
                    if (lastOff == null)
                        lastOff = o.offset();
                    var newPos = o.position();
                    var newOff = o.offset();
                    if (lastPos.top != newPos.top || lastPos.left != newPos.left) {
                        $(this).trigger('onPositionChanged', {lastPos: lastPos, newPos: newPos});
                        if (typeof (trigger) == "function")
                            trigger(lastPos, newPos);
                        lastPos = o.position();
                    }
                    if (lastOff.top != newOff.top || lastOff.left != newOff.left) {
                        $(this).trigger('onOffsetChanged', {lastOff: lastOff, newOff: newOff});
                        if (typeof (trigger) == "function")
                            trigger(lastOff, newOff);
                        lastOff = o.offset();
                    }
                }, millis);

                return o;
            };

            $(".car").onPositionChanged(function () {
                if (second())
                {
                    alert('wasted');
                    $('.game').html('');
                    $('.score').show();
                }
            });

            function second() {
//                console.log('tr');
                $div1 = $('.bot-car');
                $div2 = $('.car');
                var x1 = $div1.offset().left + 20;
                var y1 = $div1.offset().top;
                var h1 = $div1.outerHeight(true);
                var w1 = $div1.outerWidth(true);
                var b1 = y1 + h1;
                var r1 = x1 + w1;
                var x2 = $div2.offset().left;
                var y2 = $div2.offset().top;
                var h2 = $div2.outerHeight(true);
                var w2 = $div2.outerWidth(true);
                var b2 = y2 + h2;
                var r2 = x2 + w2;

                if (b1 < y2 || y1 > b2 || r1 < x2 || x1 > r2) {
                    return false;
                } else {

                }
                return true;
            }
            function moveCarUp() {
                console.log($('.car').css('top'));
                $('.car').css({'top': (parseFloat($('.car').css('top')) - 10) + 'px'});
            }
            
            function moveCarDown() {
                console.log($('.car').css('top'));
                $('.car').css({'top': (parseFloat($('.car').css('top')) + 4) + 'px'});
            }
            
            function moveCarLeft() {
                console.log($('.car').css('left'), $('.car').css('right'));
                $(".car").animate({left: "-=50"}, 0);  
//                $('.car').css({'left': (parseFloat($('.car').css('left')) - 300) + 'px'});
//                $('.car').css({'right': (parseFloat($('.car').css('right')) + 300) + 'px'});
            }
        </script>
    </body>
</html>